---
title: "Simple Exploration of Heart Disease Data"
authors: "Miftaj Chowdhury, Abhi Adusumilli, Brady Seyler"
date: "Wednesday, December 17, 2025"
date-format: full
date-modified: now
format: pdf
execute: 
  echo: true
  eval: true
  warning: false
---

# Introduction

The goal of this project is to explore patterns related to heart disease using patient health data. We focus on understanding what factors are associated with heart disease. The data set is formatted similarly to the UCI Heart Disease data set. Each row represents a 
patient, and variables include age, sex, cholesterol level, resting blood pressure, maximum heart rate, and a binary heart disease indicator.

# Inserting the Data

```{r}
#| label: loadPackages
#| eval: true
#| echo: false
#| results: hide
# Loading useful packages
library(tidyverse)
library(ggplot2)
```

```{r}
#| label: readData
#| eval: true
#| echo: false
#| results: hide
# Reading the heart data into R
heart <- read_csv("heart.csv .txt", col_names = FALSE)
```

```{r}
#| label: viewData
#| eval: true
#| echo: false
# Viewing the first lines of the data set
head(heart)
```

We first started by inserting the data into R. This is what the data frame first looked liked before we tidied it.

```{r}
#| label: columnNames
#| eval: true
#| echo: false
#| results: hide
# These names come from the original UCI Heart Disease dataset.
colnames(heart) <- c(
  "age", "sex", "cp", "trestbps", "chol", "fbs",
  "restecg", "thalach", "exang", "oldpeak",
  "slope", "ca", "thal", "target"
)
```

```{r}
#| label: tidyData
#| eval: true
#| echo: false
#| results: hide
#Converting the data into all numeric values
heart_clean <- heart %>%
  mutate(across(everything(), as.numeric))
#Removing unneeded rows
heart_clean <- heart_clean %>%
  filter(target <= 1)
#Fixing the names for the factor variables
heart_clean <- heart_clean %>%
  mutate(
    sex = factor(sex, labels = c("Female", "Male")),
    target = factor(target, labels = c("No Disease", "Disease")),
    cp = factor(cp),
    exang = factor(exang),
    slope = factor(slope)
  )
```

```{r}
#| label: viewTidy
#| eval: true
#| echo: false
# Viewing the tidied data
glimpse(heart_clean)
```

We then tidied the data, which included removing all cases where the patient wasn't labeled as either having or not having heart disease. Additionally, we changed the output of sex and target from 0 or 1 to Female or Male and No Disease or Disease respectively. This is a look at the tidied data.

```{r}
#| label: summaryStats
#| eval: true
#| echo: false
#These give us a quick overview of the data.
heart_clean %>%
  summarize(
    average_age = mean(age),
    average_cholesterol = mean(chol),
    average_resting_bp = mean(trestbps)
  )
# Count how many males/females have disease/no disease
heart_clean %>% count(sex, target)
```

These two tables show summary statistics of the data, including average age, cholesterol, and resting blood pressure. It also shows how many men and women in the data did and did not have heart disease. These tables will become more relevant with the visualizations below. 

# Visualizations

```{r}
#| label: Plot1 
#| eval: true
#| echo: false
# Bar Graph shows information on who does and doesn't have heart disease.
ggplot(heart_clean, 
       aes(
         x = target,
         colour = sex)
       ) +
  geom_bar() +
  labs(
    title = "Heart Disease vs No Heart Disease",
    subtitle = "Sepereated by Sex",
    x = "Condition",
    y = "Number of People",
    colour = "Sex",
    alt = "Bar Chart showing how many men and women have heart disease within the data."
  ) +
  theme_minimal()
```

This plot shows the number of people in the data set that had and did not have heart disease. It additionally shows the sex proportions between who did and did not have heart disease. From the graph you can see that there are significantly more men that had heart disease than women in the data, which coincides with the table that was shown earlier. 

```{r}
#| label: Plot2 
#| eval: true
#| echo: false
# Histogram shows information on the ages of the people in the data set.
ggplot(heart_clean,
       aes(age)
       ) + 
  geom_histogram(bins = 20, fill = "blue") + 
  labs(
    title = "Distribution of Patient Ages", 
    x = "Age", 
    y = "Count",
    alt = "Histogtram showing the distribution of the ages of the people in the dataset."
    ) + 
  theme_minimal()
```

Knowing the average age of the people in the data set is important when interpreting the data, which is what this histogram shows us. The range of ages spans from about 30 to 75. The distribution of the ages is bimodal, with the two peaks being around 45 and 55. This information will help bring context to future visualizations by knowing the ages of the people in the data set. 

```{r}
#| label: Plot3 
#| eval: true
#| echo: false
# Box plot shows difference in Cholesterol levels for people with and without heart disease.
ggplot(heart_clean, 
       aes(target, chol)
       ) + 
  geom_boxplot() + 
  labs(
    title = "Cholesterol Levels by Heart Disease Status", 
    x = "Condition", 
    y = "Cholesterol",
    alt = "Box plots showing the cholesterol levels for people with and without heart disease."
    ) +
  theme_minimal()
```

This side by side box plot shows the difference in cholesterol levels for people with and without heart disease. The average cholesterol levels for people with heart disease seems to be higher than the levels for people without. While we can't confirm exact causation with just this plot, there is certainly a possibility that higher cholesterol levels could be a factor in heart disease. 

```{r}
#| label: Plot4 
#| eval: true
#| echo: false
# Box plot shows difference in resting blood pressure for people with and without heart disease.
ggplot(heart_clean, 
       aes(target, trestbps)
       ) + 
  geom_boxplot() + 
  labs(
    title = "Resting Blood Pressure by Heart Disease Status", 
    x = "Condition", 
    y = "Blood Pressure",
    alt = "Box plots showing the resting blood pressure for people with and without heart disease."
    ) +
  theme_minimal()
```

This side by side box plot shows the difference in resting blood pressure for people with and without blood pressure. The average blood pressure is almost identical for people with and without blood pressure, so this can not be used as an indicator for heart disease from this data set alone.

```{r}
#| label: Plot5 
#| eval: true
#| echo: false
# Box plot shows difference in max heart rate for people with and without heart disease. 
ggplot(heart_clean, 
       aes(target, thalach)
       ) + 
  geom_boxplot() + 
  labs(
    title = "Max Heart Rate by Heart Disease Status", 
    x = "Condition", 
    y = "Max Heart Rate",
    alt = "Box plots showing the max heart rate for people with and without heart disease."
    ) +
  theme_minimal()
```

This side by side box plot shows the difference in max heart rate for people with and without heart disease. The average max heart rate for people with heart disease seems to be less than the average heart rate for people without heart disease. This should be considered when looking into factors for heart disease.
## Relationship Between Age and Maximum Heart Rate

#| label: Plot3
#| eval: true
#| echo: false
# Scatterplot shows relationship between age and max heart rate.
ggplot(
heart_clean,
aes(
x = age,
y = thalach,
color = target
)
) +
geom_point(alpha = 0.6) +
labs(
title = "Age vs Maximum Heart Rate",
subtitle = "Colored by Heart Disease Status",
x = "Age",
y = "Maximum Heart Rate Achieved",
color = "Condition",
alt = "Scatter plot showing age on the x-axis and maximum heart rate on the y-axis, colored by heart disease status."
) +
theme_minimal()

<<<<<<< Updated upstream
This scatter plot explores the relationship between age and maximum heart rate achieved.
=======
This scatter plot explores the relationship between age and maximum heart rate achieved. As age increases, maximum heart rate is expected to decrease. So when combining this with the previous plot, an increase in age could be a factor in getting heart disease, since people with heart disease had lower max heart rates than people without heart disease.

# Conclusion

After creating multiple visualizations we can claim that older men with low max heart rates and high cholesterol levels are at most risk to get heart disease.

# Code Appendix

```{r codeAppend, ref.label=knitr::all_labels(), echo=TRUE, eval=FALSE}
```

>>>>>>> Stashed changes
